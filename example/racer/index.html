<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Game Frame Example</title>
        <meta name="description" content="TODO"/>
        <meta name="viewport" content="width=device-width" />
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="mobile-web-app-capable" content="yes">
        <link rel="manifest" href="//www.carolinaignites.org/assets/js/manifest.json">
        <link href="//www.carolinaignites.org/assets/css/gameframe.css" rel="stylesheet">
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    </head>
    <body>

    <svg id="game">
            <!-- <rect id="obst" class="static" width="59" height="149" x=300 y=700 img="rainbow.png"> </rect> -->
            <rect id="player" class="static" width="59" height="149" x=500 y=650 img="speedRcrRsm.png"> </rect>
            <rect id="floor" class="static" width="2000" height="20" x=1000 y=759> </rect>
    </svg>

    <svg id="templates">
        <rect class="movable block" width="100" height="50" x=25 y=25 img="wow.png"> </rect>
    </svg>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PhysicsJS/0.7.0/physicsjs-full.min.js"></script>
    <script src="//www.carolinaignites.org/assets/js/interactive-custom.js"></script>
    <script src="/src/js/gameframe.js"></script>

    <script type="text/javascript">
    let count = 10;
    let obsticales = 0;

        new GameFrame({
                "name": "Speed Racer!",
                "instructions": `Hit the left, right arrow keys to 
                    move the Racer. Hit the up down arrow key to
                    speed up.`,
                "boundaries": true,
                "impulse": true,
                "gravity": true,

            },function(gf){

                obst = function(seed){                
                    gf.template(".block", seed * 100 + (100 * Math.random() - 50), 50 + 200 * Math.random());
                    obsticales +=1;
                    
                    
                }

                gf.collision(".block", "#floor", function(data, lookup){
                    gf.remove(data[".block"]);
                    gf.score(10);
                    obsticales -= 1 ;
                })

                gf.collision(".block", "#player", function(data, lookup){
                    gf.gameOver();
                })

                gf.registerKeys(".block", {
                    'poke': function(block, lookup){
                        if(block) gf.gameOver();
                    }
                })

                gf.registerKeys("#player", {
                    'right': function(player, lookup){
                        player.state.pos.x += 30;
                    },
                    'left': function(player, lookup){
                        player.state.pos.x -= 30;
                    },
                    'up': function(player, lookup){
                        player.state.pos.y -= 30;
                    },
                    'down': function(player, lookup){
                        player.state.pos.y += 30;
                    }
                })

                gf.registerLoops(function(lookup){
                    console.log("Obsitcales: ", obsticales, "Count: ", count)
                    let randChance = Math.random()*1000;
                    if(randChance < count || obsticales < 3){
                        obst((Math.random()*count) | 0);
                    }
                });

                for (let i = 0; i < count; i++) {
                    let randChance = Math.random()*10;

                    if(randChance < 4){
                        obst(i);
                    }
                }



            })
    </script>


    </body>
</html>